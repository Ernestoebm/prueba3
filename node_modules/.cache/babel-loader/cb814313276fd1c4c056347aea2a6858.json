{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\netob\\\\OneDrive\\\\Escritorio\\\\proj\\\\src\\\\Components\\\\Posts\\\\Post.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport useAxios from \"axios-hooks\";\nimport { FontAwesomeIcon as Icon } from \"@fortawesome/react-fontawesome\";\nimport { faComment, faHeart, faEye } from \"@fortawesome/free-solid-svg-icons\";\nimport { generate } from \"shortid\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { useAuth } from \"../../Hooks/useAuth\";\nimport { useLocation } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Comment = _ref => {\n  let {\n    description,\n    user\n  } = _ref;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-xs px-4 py-2 space-y-2 border-t border-gray-400 lg:text-sm\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"font-bold\",\n      children: [\"@\", user.username]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: description\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 9\n  }, this);\n};\n\n_c = Comment;\n\nconst AddComment = _ref2 => {\n  _s();\n\n  var _auth$user;\n\n  let {\n    postId,\n    triggerUpdate\n  } = _ref2;\n  const comm = useRef(null);\n  const [emptyInput, setEmptyInput] = useState();\n  const auth = useAuth();\n  const [, createComment] = useAxios({\n    url: `${process.env.REACT_APP_API}/post/comment/${postId}`,\n    method: 'PATCH',\n    headers: {\n      Authorization: `Bearer ${auth === null || auth === void 0 ? void 0 : (_auth$user = auth.user) === null || _auth$user === void 0 ? void 0 : _auth$user.token}`\n    }\n  }, {\n    manual: true\n  });\n\n  async function onSubmit(e) {\n    var _comm$current;\n\n    e.preventDefault();\n\n    if ((comm === null || comm === void 0 ? void 0 : (_comm$current = comm.current) === null || _comm$current === void 0 ? void 0 : _comm$current.value) === \"\") {\n      alert('No puedes agregar un comentario vacio');\n      return;\n    }\n\n    try {\n      var _comm$current2;\n\n      await createComment({\n        data: {\n          description: comm === null || comm === void 0 ? void 0 : (_comm$current2 = comm.current) === null || _comm$current2 === void 0 ? void 0 : _comm$current2.value\n        }\n      });\n      await triggerUpdate();\n      setEmptyInput('');\n    } catch (err) {\n      console.log(err.response);\n      alert('error');\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"w-full px-4 my-2\",\n    onSubmit: onSubmit,\n    children: /*#__PURE__*/_jsxDEV(\"input\", {\n      ref: comm,\n      className: \"w-full rounded-lg px-2 py-1 border-2 border-primary text-sm\",\n      type: \"text\",\n      value: emptyInput,\n      placeholder: \"Presiona enter para comentar...\",\n      onChange: e => setEmptyInput(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 9\n  }, this);\n};\n\n_s(AddComment, \"8Y3pZG5dcBhDcCVK/lVoRkmc5nA=\", false, function () {\n  return [useAuth, useAxios];\n});\n\n_c2 = AddComment;\n\nconst Post = _ref3 => {\n  _s2();\n\n  var _auth$user2, _auth$user3, _auth$user4, _auth$user6, _internalPost$likes$l;\n\n  let {\n    post\n  } = _ref3;\n  const auth = useAuth();\n  const [identity, setIdentity] = useState();\n  const location = useLocation();\n  const [internalPost, setInternalPost] = useState(post);\n  const [showComments, setShowComments] = useState(false);\n  const [isActive, setIsActive] = useState(internalPost.active);\n  const [, update] = useAxios({\n    url: `${process.env.REACT_APP_API}/post/one/${internalPost._id}`,\n    headers: {\n      Authorization: `Bearer ${auth === null || auth === void 0 ? void 0 : (_auth$user2 = auth.user) === null || _auth$user2 === void 0 ? void 0 : _auth$user2.token}`\n    }\n  }, {\n    manual: true\n  });\n  const [, likePost] = useAxios({\n    url: `${process.env.REACT_APP_API}/post/like/${internalPost._id}`,\n    method: 'PATCH',\n    headers: {\n      Authorization: `Bearer ${auth === null || auth === void 0 ? void 0 : (_auth$user3 = auth.user) === null || _auth$user3 === void 0 ? void 0 : _auth$user3.token}`\n    }\n  }, {\n    manual: true\n  });\n  const [, togglePost] = useAxios({\n    url: `${process.env.REACT_APP_API}/post/toggle/${internalPost._id}`,\n    method: 'PATCH',\n    headers: {\n      Authorization: `Bearer ${auth === null || auth === void 0 ? void 0 : (_auth$user4 = auth.user) === null || _auth$user4 === void 0 ? void 0 : _auth$user4.token}`\n    }\n  }, {\n    manual: true\n  });\n\n  async function triggerUpdate(callback) {\n    try {\n      if (callback) await callback();\n      let {\n        data: updateData\n      } = await update();\n      setInternalPost(updateData);\n    } catch (err) {\n      if (location.pathname === \"/my\") alert('Post desactivado');else alert('error sad');\n    }\n  }\n\n  useEffect(() => {\n    async function getIdentity() {\n      try {\n        var _auth$user5;\n\n        let res = await axios.get(`${process.env.REACT_APP_API}/auth/whoami`, {\n          headers: {\n            Authorization: `Bearer ${auth === null || auth === void 0 ? void 0 : (_auth$user5 = auth.user) === null || _auth$user5 === void 0 ? void 0 : _auth$user5.token}`\n          }\n        });\n        setIdentity(res.data.username);\n      } catch (err) {\n        alert('Error');\n      }\n    }\n\n    getIdentity();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full rounded-lg bg-gray-300 flex flex-col mb-6 md:w-2/5 md:m-4 lg:w-1/4 relative\",\n    children: [location.pathname === \"/my\" && (auth === null || auth === void 0 ? void 0 : (_auth$user6 = auth.user) === null || _auth$user6 === void 0 ? void 0 : _auth$user6.role) === \"admin\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `absolute top-0 right-0 p-2 space-x-1 flex items-center cursor-pointer\n                    ${isActive && 'text-red-800'}`,\n      onClick: () => {\n        triggerUpdate(togglePost);\n        setIsActive(!isActive);\n      },\n      children: /*#__PURE__*/_jsxDEV(Icon, {\n        icon: faEye\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `absolute top-0 right-0 p-2 space-x-1 flex items-center cursor-pointer\n                    ${internalPost.likes.some(it => it.username === identity) && 'text-red-800'}`,\n      onClick: () => triggerUpdate(likePost),\n      children: [/*#__PURE__*/_jsxDEV(Icon, {\n        icon: faHeart\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs\",\n        children: (_internalPost$likes$l = internalPost.likes.length) !== null && _internalPost$likes$l !== void 0 ? _internalPost$likes$l : 0\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-400 rounded-t px-4 py-2 font-medium space-y-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-xs text-gray-800 lg:text-sm\",\n        children: [\"@ \", internalPost.user.username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-sm lg:text-base\",\n        children: internalPost.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }, this), internalPost.image && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full \",\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"h-40 w-full object-contain\",\n        src: internalPost.image,\n        alt: internalPost.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-4 py-2 text-sm lg:text-base\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: internalPost.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full bg-gray-400 text-center py-2 cursor-pointer select-none\",\n      onClick: () => setShowComments(!showComments),\n      children: internalPost.comments.length > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [/*#__PURE__*/_jsxDEV(Icon, {\n          icon: faComment\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 29\n        }, this), \" Mostrar comentarios\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [showComments && internalPost.comments.map(it => /*#__PURE__*/_jsxDEV(Comment, {\n        description: it.description,\n        user: it.user\n      }, generate(), false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 73\n      }, this)), /*#__PURE__*/_jsxDEV(AddComment, {\n        postId: internalPost._id,\n        triggerUpdate: triggerUpdate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(Post, \"QwcqA5sRiSG1+YH87ZKTO1kua1w=\", false, function () {\n  return [useAuth, useLocation, useAxios, useAxios, useAxios];\n});\n\n_c3 = Post;\nexport default Post;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Comment\");\n$RefreshReg$(_c2, \"AddComment\");\n$RefreshReg$(_c3, \"Post\");","map":{"version":3,"sources":["C:/Users/netob/OneDrive/Escritorio/proj/src/Components/Posts/Post.js"],"names":["useAxios","FontAwesomeIcon","Icon","faComment","faHeart","faEye","generate","useEffect","useRef","useState","useAuth","useLocation","axios","Comment","description","user","username","AddComment","postId","triggerUpdate","comm","emptyInput","setEmptyInput","auth","createComment","url","process","env","REACT_APP_API","method","headers","Authorization","token","manual","onSubmit","e","preventDefault","current","value","alert","data","err","console","log","response","target","Post","post","identity","setIdentity","location","internalPost","setInternalPost","showComments","setShowComments","isActive","setIsActive","active","update","_id","likePost","togglePost","callback","updateData","pathname","getIdentity","res","get","role","likes","some","it","length","title","image","comments","map"],"mappings":"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","sourcesContent":["import useAxios from \"axios-hooks\";\n\nimport { FontAwesomeIcon as Icon } from \"@fortawesome/react-fontawesome\";\nimport { faComment, faHeart, faEye } from \"@fortawesome/free-solid-svg-icons\";\nimport { generate } from \"shortid\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { useAuth } from \"../../Hooks/useAuth\";\nimport { useLocation } from \"react-router-dom\";\nimport axios from \"axios\";\n\nconst Comment = ({ description, user }) => {\n    return (\n        <div className=\"text-xs px-4 py-2 space-y-2 border-t border-gray-400 lg:text-sm\">\n            <h1 className=\"font-bold\">@{user.username}</h1>\n            <h2>{ description }</h2>\n        </div>\n    )\n}\n\nconst AddComment = ({ postId, triggerUpdate }) => {\n    const comm = useRef(null);\n    const [emptyInput, setEmptyInput] = useState();\n    const auth = useAuth();\n\n    const [, createComment] = useAxios({\n        url: `${process.env.REACT_APP_API}/post/comment/${postId}`,\n        method: 'PATCH',\n        headers: {\n            Authorization: `Bearer ${auth?.user?.token}`\n        }\n    }, { manual: true });\n\n    async function onSubmit(e) {\n        e.preventDefault();\n\n        if (comm?.current?.value === \"\") {\n            alert('No puedes agregar un comentario vacio');\n            return;\n        }\n\n        try {\n            await createComment({ data: { description: comm?.current?.value } });\n            await triggerUpdate();\n\n            setEmptyInput('');\n        } catch(err) {\n            console.log(err.response);\n            alert('error');\n        }\n    }\n\n    return (\n        <form className=\"w-full px-4 my-2\" onSubmit={onSubmit}>\n            <input ref={comm} \n                className=\"w-full rounded-lg px-2 py-1 border-2 border-primary text-sm\" \n                type=\"text\"\n                value={emptyInput}\n                placeholder=\"Presiona enter para comentar...\"\n                onChange={(e) => setEmptyInput(e.target.value)}\n            />\n        </form>\n    )\n}\n\nconst Post = ({ post }) => {\n    const auth = useAuth();\n    const [identity, setIdentity] = useState();\n    const location = useLocation();\n\n    const [internalPost, setInternalPost] = useState(post);\n    const [showComments, setShowComments] = useState(false);\n    const [isActive, setIsActive] = useState(internalPost.active);\n\n    const [, update] = useAxios({\n        url: `${process.env.REACT_APP_API}/post/one/${internalPost._id}`,\n        headers: {\n            Authorization: `Bearer ${auth?.user?.token}`\n        }\n    }, { manual: true });\n\n    const [, likePost] = useAxios({\n        url: `${process.env.REACT_APP_API}/post/like/${internalPost._id}`,\n        method: 'PATCH',\n        headers: {\n            Authorization: `Bearer ${auth?.user?.token}`\n        }\n    }, { manual: true });\n\n    const [, togglePost] = useAxios({\n        url: `${process.env.REACT_APP_API}/post/toggle/${internalPost._id}`,\n        method: 'PATCH',\n        headers: {\n            Authorization: `Bearer ${auth?.user?.token}`\n        }\n    }, { manual: true });\n\n    async function triggerUpdate(callback) {\n        try {\n            if (callback)\n                await callback();\n\n            let { data: updateData } = await update();\n            setInternalPost(updateData);\n        } catch(err) {\n            if (location.pathname === \"/my\")\n                alert('Post desactivado');\n            else\n                alert('error sad');\n        }\n    }\n\n    useEffect(() => {\n        async function getIdentity() {\n            try {\n                let res = await axios.get(`${process.env.REACT_APP_API}/auth/whoami`, {\n                    headers: {\n                        Authorization: `Bearer ${auth?.user?.token}`\n                    }\n                });\n                setIdentity(res.data.username);\n            } catch(err) {\n                alert('Error');\n            }\n        }\n\n        getIdentity();\n    }, []);\n\n    return (\n        <div className=\"w-full rounded-lg bg-gray-300 flex flex-col mb-6 md:w-2/5 md:m-4 lg:w-1/4 relative\">\n            {\n                location.pathname === \"/my\" && auth?.user?.role === \"admin\"\n                ?\n                <div \n                    className={`absolute top-0 right-0 p-2 space-x-1 flex items-center cursor-pointer\n                    ${ isActive && 'text-red-800' }`}\n                    onClick={() => { \n                        triggerUpdate(togglePost);\n                        setIsActive(!isActive);\n                    }}\n                >\n                    <Icon icon={faEye} />\n                </div>\n                :\n                <div \n                    className={`absolute top-0 right-0 p-2 space-x-1 flex items-center cursor-pointer\n                    ${ internalPost.likes.some(it => it.username === identity) && 'text-red-800' }`}\n                    onClick={() => triggerUpdate(likePost)}\n                >\n                    <Icon icon={faHeart} />\n                    <span className=\"text-xs\">{internalPost.likes.length ?? 0}</span>\n                </div>\n            }\n            <div className=\"bg-gray-400 rounded-t px-4 py-2 font-medium space-y-2\">\n                <h1 className=\"text-xs text-gray-800 lg:text-sm\">@ { internalPost.user.username }</h1>\n                <h2 className=\"text-sm lg:text-base\">{ internalPost.title }</h2>\n            </div>\n            {\n                internalPost.image && \n                <div className=\"w-full \">\n                    <img className=\"h-40 w-full object-contain\" src={internalPost.image} alt={internalPost.title} />\n                </div>\n            }\n            <div className=\"px-4 py-2 text-sm lg:text-base\">\n                <p>{ internalPost.description }</p>\n            </div>\n            <div className=\"w-full bg-gray-400 text-center py-2 cursor-pointer select-none\" onClick={() => setShowComments(!showComments)}>\n                {\n                    internalPost.comments.length > 0 && \n                        <span>\n                            <Icon icon={faComment} /> Mostrar comentarios\n                        </span>\n                }\n            </div>\n            <div>\n                {\n                    (showComments) && internalPost.comments.map((it) => <Comment key={ generate() } description={it.description} user={it.user} />)\n                }\n                <AddComment postId={internalPost._id} triggerUpdate={triggerUpdate} />\n            </div>\n        </div>\n    )\n}\n\nexport default Post;\n"]},"metadata":{},"sourceType":"module"}